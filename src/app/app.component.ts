import { Component, OnInit } from '@angular/core';
import { MapMyRydeService } from './services/map-my-ryde.service';
import { Response } from '@angular/http';
import 'rxjs/Rx';

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.css']
})
export class AppComponent implements OnInit {

  workouts: Array<Object>;

  constructor(private mapMyRideService: MapMyRydeService) { }

  ngOnInit() {
    
    this.workouts = 
    //2015 - diciembre
    // [{ id: 1278941251, src: '' },
    // { id: 1280225203, src: '' },
    // { id: 1280787885, src: '' },
    // { id: 1281087461, src: '' },
    // { id: 1281534465, src: '' },
    // { id: 1284196043, src: '' },
    // { id: 1284726053, src: '' },
    // { id: 1285009017, src: '' },
    // { id: 1285526063, src: '' },
    // { id: 1289812625, src: '' },
    // { id: 1290420485, src: '' },
    // { id: 1291706349, src: '' }];
    //2016 - enero
    // [
    //     { id: 1306708809, src: '' },
    //     { id: 1307527993, src: '' },
    //     { id: 1304330497, src: '' },
    //     { id: 1304729075, src: '' },
    //     { id: 1303464723, src: '' },
    //     { id: 1303722699, src: '' },
    //     { id: 1301826655, src: '' },
    //     { id: 1302470509, src: '' },
    //     { id: 1300530719, src: '' },
    //     { id: 1301392377, src: '' },
    //     { id: 1298091513, src: '' },
    //     { id: 1298855099, src: '' },
    //     { id: 1296801447, src: '' },
    //     { id: 1297653697, src: '' },
    //     { id: 1307988921, src: '' },
    //     { id: 1308771227, src: '' },
    //     { id: 1309220277, src: '' },
    //     { id: 1310033487, src: '' },
    //     { id: 1310421169, src: '' },
    //     { id: 1311078179, src: '' },
    //     { id: 1313086899, src: '' },
    //     { id: 1317520151, src: '' },
    //     { id: 1318197523, src: '' },
    //     { id: 1318631617, src: '' },
    //     { id: 1319195989, src: '' },
    //     { id: 1320767933, src: '' },
    //     { id: 1321003527, src: '' },
    //     { id: 1321167499, src: '' },
    //     { id: 1323230309, src: '' },
    //     { id: 1324052057, src: '' },
    //     { id: 1324380735, src: '' },
    //     { id: 1324408683, src: '' },
    //     { id: 1324454909, src: '' },
    //     { id: 1325282969, src: '' },
    //     { id: 1326885881, src: '' },
    //     { id: 1327542849, src: '' },
    //     { id: 1289812625, src: '' },
    //     { id: 1290420485, src: '' },
    //     { id: 1291706349, src: '' }
    // ];
    //2016 - febrero
    // [
    //   { id: 1343875897, src: '' },
    //   { id: 1344507285, src: '' },
    //   { id: 1342747335, src: '' },
    //   { id: 1343432217, src: '' },
    //   { id: 1370023999, src: '' },
    //   { id: 1370718699, src: '' },
    //   { id: 1368833971, src: '' },
    //   { id: 1369620169, src: '' },
    //   { id: 1368363939, src: '' },
    //   { id: 1366225285, src: '' },
    //   { id: 1344799183, src: '' },
    //   { id: 1345314113, src: '' },
    //   { id: 1346906763, src: '' },
    //   { id: 1354842099, src: '' },
    //   { id: 1355820101, src: '' },
    //   { id: 1356715827, src: '' },
    //   { id: 1357223209, src: '' },
    //   { id: 1358093049, src: '' },
    //   { id: 1358456873, src: '' },
    //   { id: 1359686735, src: '' },
    //   { id: 1360408437, src: '' },
    //   { id: 1360836955, src: '' },
    //   { id: 1361488743, src: '' },
    //   { id: 1364776153, src: '' },
    //   { id: 1365666999, src: '' }
    // ];
    //2016 - marzo
    // [
    //   { id:1381004865, src: '' },
    //   { id:1381807597, src: '' },
    //   { id:1376862679, src: '' },
    //   { id:1378251605, src: '' },
    //   { id:1375291163, src: '' },
    //   { id:1376362003, src: '' },
    //   { id:1373729643, src: '' },
    //   { id:1374787243, src: '' },
    //   { id:1370023999, src: '' },
    //   { id:1370718699, src: '' },
    //   { id:1368833971, src: '' },
    //   { id:1369620169, src: '' },
    //   { id:1368363939, src: '' },
    //   { id:1409747253, src: '' },
    //   { id:1410434281, src: '' },
    //   { id:1366225285, src: '' },
    //   { id:1364776153, src: '' },
    //   { id:1365666999, src: '' },
    //   { id:1384023307, src: '' },
    //   { id:1384148485, src: '' },
    //   { id:1385632929, src: '' },
    //   { id:1385933615, src: '' },
    //   { id:1386516589, src: '' },
    //   { id:1387474795, src: '' },
    //   { id:1387540807, src: '' },
    //   { id:1388034277, src: '' },
    //   { id:1389012279, src: '' },
    //   { id:1389548699, src: '' },
    //   { id:1390430589, src: '' },
    //   { id:1390839889, src: '' },
    //   { id:1394849095, src: '' },
    //   { id:1395988279, src: '' },
    //   { id:1396983601, src: '' },
    //   { id:1397546249, src: '' },
    //   { id:1398338993, src: '' },
    //   { id:1402970127, src: '' },
    //   { id:1403778839, src: '' },
    //   { id:1404051255, src: '' },
    //   { id:1404740081, src: '' },
    //   { id:1405270599, src: '' },
    //   { id:1405649989, src: '' },
    //   { id:1406405739, src: '' },
    //   { id:1406813513, src: '' },
    //   { id:1407800215, src: '' }
    // ]
    // 2016 - abril
    // [
    //   { id:1424239729, src:''},
    //   { id:1425252189, src:''},
    //   { id:1422781139, src:''},
    //   { id:1423688835, src:''},
    //   { id:1421955081, src:''},
    //   { id:1419151441, src:''},
    //   { id:1419804535, src:''},
    //   { id:1417899931, src:''},
    //   { id:1418647835, src:''},
    //   { id:1414998139, src:''},
    //   { id:1415949897, src:''},
    //   { id:1409747253, src:''},
    //   { id:1410434281, src:''},
    //   { id:1402970127, src:''},
    //   { id:1403778839, src:''},
    //   { id:1404051255, src:''},
    //   { id:1404740081, src:''},
    //   { id:1405270599, src:''},
    //   { id:1405649989, src:''},
    //   { id:1406405739, src:''},
    //   { id:1406813513, src:''},
    //   { id:1407800215, src:''},
    //   { id:1425744013, src:''},
    //   { id:1426751957, src:''},
    //   { id:1427276055, src:''},
    //   { id:1428217769, src:''},
    //   { id:1428691577, src:''},
    //   { id:1429506363, src:''},
    //   { id:1430790999, src:''},
    //   { id:1433065907, src:''},
    //   { id:1434189489, src:''},
    //   { id:1434824011, src:''},
    //   { id:1435995711, src:''},
    //   { id:1436644747, src:''},
    //   { id:1437860567, src:''},
    //   { id:1438388419, src:''},
    //   { id:1439911439, src:''},
    //   { id:1439911559, src:''},
    //   { id:1440724567, src:''},
    //   { id:1444353549, src:''},
    //   { id:1446121245, src:''},
    //   { id:1446121353, src:''},
    //   { id:1447064451, src:''},
    //   { id:1447673897, src:''},
    //   { id:1448638761, src:''},
    //   { id:1449174871, src:''},
    //   { id:1450564825, src:''},
    //   { id:1451285759, src:''}
    // ]
    //2016 - mayo
    // [
    //   { id:1471479933, src:''},
    //   { id:1468532997, src:''},
    //   { id:1471479861, src:''},
    //   { id:1466856405, src:''},
    //   { id:1468115421, src:''},
    //   { id:1462801163, src:''},
    //   { id:1461110357, src:''},
    //   { id:1461875831, src:''},
    //   { id:1460635377, src:''},
    //   { id:1509338693, src:''},
    //   { id:1510868933, src:''},
    //   { id:1506777755, src:''},
    //   { id:1508306690, src:''},
    //   { id:1453622325, src:''},
    //   { id:1472409401, src:''},
    //   { id:1472664699, src:''},
    //   { id:1476015009, src:''},
    //   { id:1477161177, src:''},
    //   { id:1477796047, src:''},
    //   { id:1478775051, src:''},
    //   { id:1480498625, src:''},
    //   { id:1480498793, src:''},
    //   { id:1481055215, src:''},
    //   { id:1482838630, src:''},
    //   { id:1482838774, src:''},
    //   { id:1490342571, src:''},
    //   { id:1491060083, src:''},
    //   { id:1492299869, src:''},
    //   { id:1493261348, src:''},
    //   { id:1494743297, src:''},
    //   { id:1495550897, src:''},
    //   { id:1496634443, src:''},
    //   { id:1504161362, src:''},
    //   { id:1505659244, src:''}
    // ]
    // 2016 - junio
    // [
    //   { id: 1533498449, src:''},
    //   { id: 1528629686, src:''},
    //   { id: 1529814671, src:''},
    //   { id: 1526165585, src:''},
    //   { id: 1523611175, src:''},
    //   { id: 1525150922, src:''},
    //   { id: 1520896691, src:''},
    //   { id: 1522543124, src:''},
    //   { id: 1509338693, src:''},
    //   { id: 1510868933, src:''},
    //   { id: 1576995569, src:''},
    //   { id: 1578202202, src:''},
    //   { id: 1506777755, src:''},
    //   { id: 1508306690, src:''},
    //   { id: 1504161362, src:''},
    //   { id: 1505659244, src:''},
    //   { id: 1534953425, src:''},
    //   { id: 1536447737, src:''},
    //   { id: 1537557938, src:''},
    //   { id: 1539085268, src:''},
    //   { id: 1540161605, src:''},
    //   { id: 1543869302, src:''},
    //   { id: 1544843213, src:''},
    //   { id: 1545923789, src:''},
    //   { id: 1550761868, src:''},
    //   { id: 1552282832, src:''},
    //   { id: 1553515430, src:''},
    //   { id: 1555082390, src:''},
    //   { id: 1555940810, src:''},
    //   { id: 1557438113, src:''},
    //   { id: 1558617767, src:''},
    //   { id: 1559969267, src:''},
    //   { id: 1560929195, src:''},
    //   { id: 1562044526, src:''},
    //   { id: 1567016990, src:''},
    //   { id: 1568257950, src:''},
    //   { id: 1569567069, src:''},
    //   { id: 1569694290, src:''},
    //   { id: 1571549804, src:''},
    //   { id: 1572113945, src:''},
    //   { id: 1573500119, src:''},
    //   { id: 1574673386, src:''},
    //   { id: 1575957968, src:''}
    // ]
    //2016 - julio
    // [
    //   { id:1601755685, src:'' },
    //   { id:1603179629, src:'' },
    //   { id:1599099842, src:'' },
    //   { id:1600587008, src:'' },
    //   { id:1592603963, src:'' },
    //   { id:1593783797, src:'' },
    //   { id:1590334157, src:'' },
    //   { id:1591742078, src:'' },
    //   { id:1660125248, src:'' },
    //   { id:1588001240, src:'' },
    //   { id:1589285807, src:'' },
    //   { id:1589322713, src:'' },
    //   { id:1656946553, src:'' },
    //   { id:1658142683, src:'' },
    //   { id:1585455854, src:'' },
    //   { id:1586828657, src:'' },
    //   { id:1652276645, src:'' },
    //   { id:1653604160, src:'' },
    //   { id:1649684141, src:'' },
    //   { id:1651128611, src:'' },
    //   { id:1647126296, src:'' },
    //   { id:1648533311, src:'' },
    //   { id:1576995569, src:'' },
    //   { id:1578202202, src:'' },
    //   { id:1567016990, src:'' },
    //   { id:1568257950, src:'' },
    //   { id:1569567069, src:'' },
    //   { id:1569694290, src:'' },
    //   { id:1571549804, src:'' },
    //   { id:1572113945, src:'' },
    //   { id:1573500119, src:'' },
    //   { id:1574673386, src:'' },
    //   { id:1575957968, src:'' },
    //   { id:1604369255, src:'' },
    //   { id:1608145304, src:'' },
    //   { id:1609131998, src:'' },
    //   { id:1610167676, src:'' },
    //   { id:1611762893, src:'' },
    //   { id:1619458793, src:'' },
    //   { id:1623097274, src:'' },
    //   { id:1624574429, src:'' },
    //   { id:1625156846, src:'' },
    //   { id:1626254093, src:'' },
    //   { id:1629706655, src:'' },
    //   { id:1631316914, src:'' },
    //   { id:1632678788, src:'' },
    //   { id:1633815029, src:'' },
    //   { id:1637614619, src:'' },
    //   { id:1638757493, src:'' },
    //   { id:1639927085, src:'' },
    //   { id:1640844116, src:'' },
    //   { id:1641893927, src:'' },
    //   { id:1645472009, src:'' }
    // ]
    //2016 - Agosto
    // [
    //   { id:1672922750, src:'' },
    //   { id:1674002117, src:'' },
    //   { id:1670905676, src:'' },
    //   { id:1672173941, src:'' },
    //   { id:1668564824, src:'' },
    //   { id:1669801700, src:'' },
    //   { id:1666091771, src:'' },
    //   { id:1667448152, src:'' },
    //   { id:1663408436, src:'' },
    //   { id:1664880905, src:'' },
    //   { id:1661926526, src:'' },
    //   { id:1660125248, src:'' },
    //   { id:1656946553, src:'' },
    //   { id:1658142683, src:'' },
    //   { id:1652276645, src:'' },
    //   { id:1653604160, src:'' },
    //   { id:1649684141, src:'' },
    //   { id:1651128611, src:'' },
    //   { id:1647126296, src:'' },
    //   { id:1648533311, src:'' },
    //   { id:1645472009, src:'' },
    //   { id:1681564529, src:'' },
    //   { id:1682921834, src:'' },
    //   { id:1683977414, src:'' },
    //   { id:1685274149, src:'' },
    //   { id:1686382808, src:'' },
    //   { id:1687687337, src:'' },
    //   { id:1693177457, src:'' },
    //   { id:1694701133, src:'' },
    //   { id:1696215917, src:'' },
    //   { id:1697396621, src:'' },
    //   { id:1698917975, src:'' },
    //   { id:1702500023, src:'' },
    //   { id:1703744294, src:'' },
    //   { id:1709556872, src:'' },
    //   { id:1713610757, src:'' },
    //   { id:1714955096, src:'' }
    // ]
    // 2016 - septiembre
    // [
    //   { id: 1741697708, src: '' },
    //   { id: 1725371765, src: '' },
    //   { id: 1709556872, src: '' },
    //   { id: 1713610757, src: '' },
    //   { id: 1714955096, src: '' },
    //   { id: 1772436497, src: '' }
    // ]
    // 2016 - octubre
    // [
    //   { id:1850630255, src: '' },
    //   { id:1772436497, src: '' },
    //   { id:1827556685, src: '' }
    // ]
    // 2016 - noviembre
    // [
    //   { id: 1854640754, src: '' },
    //   { id: 1850630255, src: '' },
    //   { id: 1893619115, src: '' },
    //   { id: 1866416615, src: '' },
    //   { id: 1886461229, src: '' }
    // ]
    // 2016 - diciembre
    // [
    //   { id: 1893619115, src: '' },
    //   { id: 1886461229, src: '' },
    //   { id: 1915592354, src: '' }
    // ]

    //2017 - enero
    // [
    //   { id: 1941458630, src: '' },
    //   { id: 1940697749, src: '' },
    //   { id: 1988248904, src: '' },
    //   { id: 1952887811, src: '' },
    //   { id: 1952887814, src: '' },
    //   { id: 1967130059, src: '' }
    // ]
    //2017 - febrero
    // [
    //   { id: 2041638233, src: ''},
    //   { id: 2042609111, src: ''},
    //   { id: 2039799716, src: ''},
    //   { id: 2041044428, src: ''},
    //   { id: 1988248904, src: ''},
    //   { id: 2012149817, src: ''},
    //   { id: 2013337715, src: ''},
    //   { id: 2018152712, src: ''},
    //   { id: 2019872057, src: ''},
    //   { id: 2021466329, src: ''},
    //   { id: 2025885824, src: ''},
    //   { id: 2026526450, src: ''},
    //   { id: 2027906789, src: ''},
    //   { id: 2028539240, src: ''},
    //   { id: 2029713557, src: ''},
    //   { id: 2031546992, src: ''},
    //   { id: 2032197887, src: ''},
    //   { id: 2036016992, src: ''},
    //   { id: 2036829050, src: ''}
    // ]
    //2017 - marzo
    // [
    //   { id: 2053200020, src: '' },
    //   { id: 2054522507, src: '' },
    //   { id: 2052508526, src: '' },
    //   { id: 2049017168, src: '' },
    //   { id: 2046869135, src: '' },
    //   { id: 2048235620, src: '' },
    //   { id: 2041638233, src: '' },
    //   { id: 2042609111, src: '' },
    //   { id: 2039799716, src: '' },
    //   { id: 2041044428, src: '' },
    //   { id: 2097252281, src: '' },
    //   { id: 2098082243, src: '' },
    //   { id: 2032197887, src: '' },
    //   { id: 2036016992, src: '' },
    //   { id: 2036829050, src: '' },
    //   { id: 2080549679, src: '' },
    //   { id: 2081227778, src: '' },
    //   { id: 2082308243, src: '' },
    //   { id: 2086802264, src: '' },
    //   { id: 2088345209, src: '' },
    //   { id: 2089265831, src: '' },
    //   { id: 2090623802, src: '' },
    //   { id: 2091431969, src: '' },
    //   { id: 2094946295, src: '' },
    //   { id: 2095529135, src: '' },
    //   { id: 2096549033, src: '' }
    // ]
    //2017 - abril 17
    [
      { id:2120625377, src: '' },
      { id:2116394684, src: '' },
      { id:2114628446, src: '' },
      { id:2115282047, src: '' },
      { id:2110153019, src: '' },
      { id:2111203973, src: '' },
      { id:2108310527, src: '' },
      { id:2109499154, src: '' },
      { id:2106100676, src: '' },
      { id:2107681826, src: '' },
      { id:2103809594, src: '' },
      { id:2105294519, src: '' },
      { id:2101502282, src: '' },
      { id:2103002336, src: '' },
      { id:2097252281, src: '' },
      { id:2098082243, src: '' },
      { id:2086802264, src: '' },
      { id:2088345209, src: '' },
      { id:2089265831, src: '' },
      { id:2090623802, src: '' },
      { id:2091431969, src: '' },
      { id:2094946295, src: '' },
      { id:2095529135, src: '' },
      { id:2096549033, src: '' }
    ]
    for (var item of this.workouts) {
      //console.log(item);
      //      console.log(this.mapMyRideService.getWorkOut(item));
      item['src'] = this.mapMyRideService.getWorkOut(item['id']);
        //.subscribe(res => this.downloadFile(res), err => console.log(err))
    }

  }

  downloadFile(data: Response) {
    var blob = new Blob([data], { type: 'text/tcx' });
    var url = window.URL.createObjectURL(blob);
    window.open(url);
    window.addEventListener('unload', function () { debugger; })
  }

  downloadAll(urls){
    var link = document.createElement('a');

    link.setAttribute('download', null);
    link.style.display = 'none';

    document.body.appendChild(link);

    var i = 0;
    for (var item of urls){
      link.setAttribute('href', urls[i]['src']);
      link.click();
      i++;
    }

    document.body.removeChild(link);    
  }


}
